{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "stixBase": {
      "type": "object",
      "properties": {
        "type": { "type": "string" },
        "id": { "type": "string", "pattern": "^.*--[0-9a-fA-F-]+$" },
        "spec_version": { "type": "string", "enum": ["2.1"] },
        "created": { "type": "string", "format": "date-time" },
        "modified": { "type": "string", "format": "date-time" }
      },
      "required": ["type", "id", "spec_version", "created", "modified"]
    },
    "malware": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "is_family": { "type": "boolean" },
        "description": { "type": "string" },
        "aliases": { "type": "array", "items": { "type": "string" } },
        "kill_chain_phases": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "phase_name": { "type": "string" },
              "kill_chain_name": { "type": "string" }
            },
            "required": ["phase_name", "kill_chain_name"]
          }
        }
      },
      "required": ["name", "is_family"]
    },
    "attack-pattern": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "description": { "type": "string" },
        "kill_chain_phases": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "phase_name": { "type": "string" },
              "kill_chain_name": { "type": "string" }
            },
            "required": ["phase_name", "kill_chain_name"]
          }
        }
      },
      "required": ["name"]
    },
    "intrusion-set": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "description": { "type": "string" },
        "aliases": { "type": "array", "items": { "type": "string" } },
        "goals": { "type": "array", "items": { "type": "string" } }
      },
      "required": ["name"]
    },
    "threat-actor": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "description": { "type": "string" },
        "aliases": { "type": "array", "items": { "type": "string" } },
        "roles": { "type": "array", "items": { "type": "string" } },
        "sophistication": { "type": "string" },
        "resource_level": { "type": "string" },
        "primary_motivation": { "type": "string" },
        "secondary_motivations": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "required": ["name"]
    },
    "sighting": {
      "type": "object",
      "properties": {
        "sighting_of_ref": { "type": "string" },
        "observed_data_refs": {
          "type": "array",
          "items": { "type": "string" }
        },
        "first_seen": { "type": "string" },
        "last_seen": { "type": "string" },
        "count": { "type": "number" }
      },
      "required": ["sighting_of_ref", "first_seen", "last_seen"]
    },
    "vulnerability": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "description": { "type": "string" },
        "cvss_score": { "type": "number" },
        "source": { "type": "string" }
      },
      "required": ["name"]
    },
    "indicator": {
      "type": "object",
      "properties": {
        "pattern": { "type": "string" },
        "pattern_type": { "type": "string" },
        "valid_from": { "type": "string" },
        "valid_until": { "type": "string" },
        "labels": { "type": "array", "items": { "type": "string" } },
        "description": { "type": "string" }
      },
      "required": ["pattern", "pattern_type", "valid_from"]
    },
    "observed-data": {
      "type": "object",
      "properties": {
        "first_observed": { "type": "string" },
        "last_observed": { "type": "string" },
        "number_observed": { "type": "number" },
        "objects": { "type": "array", "items": { "type": "object" } }
      },
      "required": [
        "first_observed",
        "last_observed",
        "number_observed",
        "objects"
      ]
    },
    "relationship": {
      "type": "object",
      "properties": {
        "relationship_type": { "type": "string" },
        "source_ref": { "type": "string" },
        "target_ref": { "type": "string" },
        "description": { "type": "string" }
      },
      "required": ["relationship_type", "source_ref", "target_ref"]
    }
  }
}
